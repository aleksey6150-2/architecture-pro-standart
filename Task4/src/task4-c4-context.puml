@startuml C4_Context_Rate_Integration
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()
LAYOUT_LEFT_RIGHT()

' === ПЕРСОНЫ ===
Person(bo_employee, "Сотрудник бэк-офиса", "Управляет ставками\nПубликует ставки для партнеров")
Person(cc_operator, "Менеджер кол-центра", "Консультирует клиентов\nпо ставкам")
Person(partner_operator, "Менеджер партнерского КЦ", "Консультирует клиентов\nпо ставкам банка")

' === СУЩЕСТВУЮЩИЕ СИСТЕМЫ ===
System(cc_system, "Система кол-центра", "React/Java Spring Boot\nВнутренняя CRM")
System(rate_service, "Rate Management Service", "Java Spring Boot\nЦентрализованное управление ставками")

' === НОВЫЕ КОМПОНЕНТЫ ===
System(rate_publisher, "Rate Publisher Module", "Java Spring Boot\nМодуль экспорта ставок\nSFTP + API")
System(sftp_server, "SFTP-сервер банка", "DMZ-сегмент\nБезопасная файловая передача")

' === ВНЕШНИЕ СИСТЕМЫ ===
System(partner_cc, "Система партнерского КЦ", "Внешняя CRM\nПрием файлов по SFTP")
SystemDb(partner_db, "БД партнера", "Импортированные ставки")

' === ВЗАИМОДЕЙСТВИЯ ===
' Управление ставками
Rel(bo_employee, rate_service, "CRUD ставок", "HTTPS")
Rel(bo_employee, rate_publisher, "Запуск экспорта\nНастройка расписания", "HTTPS")

' Доступ внутреннего КЦ
Rel(cc_operator, cc_system, "Запрос ставок", "UI")
Rel(cc_system, rate_service, "GET /api/rates", "REST/HTTPS")

' Публикация для партнера
Rel(rate_service, rate_publisher, "Получение актуальных ставок", "internal")
Rel(rate_publisher, sftp_server, "Запись файлов ставок", "SFTP")
Rel(sftp_server, partner_cc, "Загрузка файлов", "SFTP (outbound)")
Rel(partner_cc, partner_db, "Импорт ставок", "JDBC/ODBC")

' Консультирование
Rel(partner_operator, partner_cc, "Просмотр ставок", "UI")

SHOW_LEGEND()
@enduml